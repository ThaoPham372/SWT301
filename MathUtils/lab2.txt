HƯỚNG DẪN LẬP TRÌNH JUNIT 5
What is Apache Maven?
 Apache Maven là một tool/công cụ/chương trình giúp quản lí mọi tác vụ xoay quanh việc viết code trong các dự án Java, bao gồm: tạo cấu trúc thư mục dự án, quản lí các thư viện đang sử dụng (được gọi là dependencies), biên dịch, kiểm thử, đóng gói sản phẩm…
 Maven cũng là 1 style hay cách thức tổ chức code dùng trong các dự án Java.
 Mọi tác vụ cần làm cho dự án (ví dụ dùng thư viện nào, có kiểm thử khi đóng gói dự án hay không, đóng gói thế nào) đều được mô tả trong một file cấu hình gọi là POM.XML.
 Một dự án Maven chuẩn sẽ có các thông số cơ bản sau đây:
o GroupId – tên tổ chức/công ty của bạn, nơi sẽ tạo ra dự án/phần mềm
o ArtifactId – tên dự án của bạn, cũng chính là thư mục sẽ chứa code
o Version – đánh số phiên bản dự án, cũng là phiên bản phần mềm khi được phát hành
 Maven sử dụng website https://mvnrepository.com/ như là cái kho tổng để chứa toàn bộ các thư viện .jar cần sử dụng cho mọi dự án Java. Để sử dụng một thư viện bất kì, cần
khai báo tên thư viện trong file POM.XML, và Maven sẽ tự động download thư viện từ kho tổng về máy bạn (máy local) và add vào dự án của bạn. Thư viện trong Maven được gọi tên là dependency.
 Có 2 cách sử dụng Maven:
o Download Maven về cài riêng lẻ trên máy và gõ lệnh mvn kèm thêm các tham số
o Maven được tích hợp sẵn trong các IDE như Eclipse, IntelliJ, NetBeans, bạn chỉ cần chọn loại dự án có chữ Maven


Bước 1: Cài đặt jdk, chọn phiên bản jdk 17.
Download ở link sau: https://www.oracle.com/java/technologies/javase/jdk17-archive-downloads.html
Nên chọn jdk 17 vì:
JDK 17 là phiên bản LTS (Long-Term Support) phổ biến, tương thích tốt với:
junit-jupiter (JUnit 5.x)
maven-surefire-plugin ≥ 2.22.2+
jacoco-maven-plugin ≥ 0.8.5+
  Sau khi tải và cài đặt JDK 17, hãy đảm bảo rằng biến môi trường JAVA_HOME được thiết lập đúng và PATH đã bao gồm đường dẫn đến thư mục bin của JDK.
  Kiểm tra phiên bản Java đã cài đặt bằng cách mở terminal hoặc command prompt và chạy lệnh:
	java -version
Kết quả sẽ hiển thị phiên bản JDK hiện tại.
Bước 2: Cài đặt netbeans 14
Bước 3: Tạo mới ứng dụng junit
Vào New Project:
-Project Name: đặt tên Project: mathutil-junit
-Project Location: chọn đường dẫn lưu dự án

 

Bước 4: Cấu hình file pom (nơi khai báo các thư viện mình cần)
Xem ở link dưới đây, để chọn phiên bản phù hợp
https://mvnrepository.com/artifact/org.junit.jupiter/junit-jupiter 

Thêm thẻ dependencies sau vào file pom, tùy thuộc vào phiên bản junit Jupiter (Aggregator)

Sau đó, nhấn vào biểu tượng   Clean and build  
Đã tải các dependencies phù hợp ở tab maven

Cấu trúc thư mục chuẩn Maven:

Bước 5: Tạo lớp cần kiểm thử
Tạo lớp MathUtil  trong package com.hanhnt.mathutil.core





Bước 6: Tạo lớp kiểm thử với junit
Tạo lớp MathUtilTest trong Test Package/ com.hanhnt.mathutil.core

Ví dụ 2: Sử dụng DDT (Data-Driven Testing)
Test script / test case không thay đổi
Dữ liệu kiểm thử được tách riêng
Test được chạy nhiều lần với các bộ dữ liệu khác nhau


    }
}

Một số điểm lưu ý khi lập trình Junit:
Chủ đề	Lưu ý
@Test	Đánh dấu phương thức kiểm thử
assertEquals, assertThrows,...	Các hàm assertion so sánh kết quả mong đợi và thực tế
Isolation (cô lập)	Mỗi phương thức test nên kiểm thử một logic duy nhất
Test Naming	Tên hàm kiểm thử nên mô tả rõ mục đích (shouldReturnX_whenConditionY)
Setup chung	Dùng @BeforeEach để khởi tạo nếu có nhiều test dùng chung
Test Coverage	Đảm bảo kiểm thử tất cả các trường hợp (normal, edge case, error case)
Không test logic trong test	Tránh viết lại logic cần kiểm thử trong test

Tìm hiểu kĩ hơn về junit 5 ở link sau: https://junit.org/junit5/docs/current/user-guide/#overview-what-is-junit-5
Bước 7: Chạy test 
Chuột phải vào class test > Test file
Hoặc dùng icon ▶️ bên cạnh tên hàm
Kết quả test hiện trong tab “Run” kèm màu xanh Pass, màu đỏ Fail)
Kết quả chạy:


Bước 8: Tạo báo cáo kiểm thử
Để tạo báo cáo kiểm thử (test report) và đo độ bao phủ mã nguồn (code coverage) trong dự án Maven sử dụng JUnit, bạn có thể dùng hai plugin sau:
Maven Surefire Plugin – để chạy test và tạo báo cáo test
Xem phiên bản mới nhất tại link: https://mvnrepository.com/artifact/org.apache.maven.plugins/maven-surefire-plugin
JaCoCo (Java Code Coverage) – để đo lường mức độ bao phủ mã
Xem phiên bản mới nhất tại link:
https://mvnrepository.com/artifact/org.jacoco/jacoco-maven-plugin
Cập nhật file pom với 2 plugin trên, thêm thẻ build vào trước thẻ </project>


Ví dụ 2: Sử dụng @ParameterizedTest với @CsvSource
Bước 1: Tạo lớp MathUtilTestFromcsv trong Test Package/ com.hanhnt.mathutil.core


Bước 2: Tạo file data.csv: Click phải vào thư mục test -> New->Directory, chọn resources. Gõ tên file factorial_test_data.csv


File factorial_test_data.csv chứa dữ liệu sau:





Bài tập nộp Lab 2: Viết unit test cho chức năng Đăng ký tài khoản.
Tạo 1 lớp AccountService có chứa ít nhất 2 phương thức:
boolean registerAccount(username, password, email)
boolean isValidEmail(email)
….
Yêu cầu: Password phải lớn hơn 6 kí tự, email hợp lệ.
Với dữ liệu đọc từ file test-data.csv như sau:
username,password,email,expected
john123,pass123,john@example.com,true
,pass123,john@example.com,false
alice,short,alice@mail.com,false
bob123,password,bobmail.com,false
carol,password,carol@domain.com,true
Yêu cầu: 
1.Viết các phương thức test để kiểm tra việc đăng ký thành công hay không?
2.Cập nhật kết quả vào file UnitTest
Bài làm theo nhóm
Thuyết trình nhóm về 1 cái Unit Test Framework tuỳ thích (ko chọn JUnit)
- Demo code để minh hoạ các khái niệm của Unit Test Framework đó (tương đương Junit kể cả xanh đỏ) vào google gõ Unit Test for <language>

Chọn đề tài, hãy lấy code môn SWP, C#, NodeJS phần back-end, front-end để demo việc đảm bảo chất lượng xử 1í của các hàm bạn viết

ví dụ: JSP/Servlet, thì Unit Test cho các hàm trong DAO

- Tuyệt đối ko sử dụng code như trên mạng, hay demo 1 class Calculation có hàm + - * /
mà phải ứng dụng trong dự án nào đó mình đã đang làm hoặc nếu ko thì tự viết hàm phức tạp theo nghĩa dùng trong dự án
- slide giới thiệu: lịch sử của FW, so sánh với ... , cài đặt, sử dụng ...

Unit Test FW thường có:
- nhóm hàm assertX() để so sánh expected và actual
- nhóm hàm bắt ngoại lệ coi có xuất hiện, ngoại lệ xuất hiện sẽ là màu đỏ, nhưng nếu kiểm soát nó, thì mà xanh
- tách data và câu lệnh test hàm riêng biệt - DDT
- chạy song song các test cases
- gài ràng buộc (dependency) giữa các test case, ví dụ login thành công thì mới CRUD
nếu test case login thành công -> chạy mấy test case sau login
			thất bại -> những test case sau login vô nghĩa

- generate ra các report/báo cáo/bản thống kê code lỗi ở những test case nào
- generate luôn các test cases để ta chỉ việc modify thay vì phải viết từ đầu.

